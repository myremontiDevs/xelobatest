"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[60],{60:(t,e,a)=>{a.r(e),a.d(e,{default:()=>h});const n={parentContainer:"CraftsmanAuthorization_parentContainer__PMhbq",mainContainer:"CraftsmanAuthorization_mainContainer__qWazR",header:"CraftsmanAuthorization_header__0UsHc",authorization:"CraftsmanAuthorization_authorization__vksJ+",authorization__labelContainer:"CraftsmanAuthorization_authorization__labelContainer__6TQM4",authorization__input:"CraftsmanAuthorization_authorization__input__fAg2-",authorization__button:"CraftsmanAuthorization_authorization__button__h5Fv5",authorization__disabledButton:"CraftsmanAuthorization_authorization__disabledButton__qy89u",authorization__relativeBox:"CraftsmanAuthorization_authorization__relativeBox__YB74H",authorization__errorMessage:"CraftsmanAuthorization_authorization__errorMessage__kSw-H",faEye:"CraftsmanAuthorization_faEye__jQuS+"};var o=a(216),r=a(413),i=a(43),s=a(910),u=a(929),l=a(858),c=a(579);const h=function(){const t=function(){const[t,e]=(0,i.useState)("");return(0,i.useEffect)((()=>{fetch("http://127.0.0.1:5500/token.json").then((t=>{if(!t.ok)throw new Error("Failed to fetch CSRF token");return t.json()})).then((t=>{console.log("Fetched CSRF Token:",t.token.csrf_token),e(t.token.csrf_token)})).catch((t=>{console.error("Error fetching CSRF token:",t)}))}),[]),t}(),e=(0,o.Zp)(),a=r,[h,_]=(0,i.useState)(!1),[d,f]=(0,i.useState)(""),[m,p]=(0,i.useState)(""),[b,z]=(0,i.useState)(!1),[C,x]=(0,i.useState)(!1),[j,v]=(0,i.useState)(null),[N,g]=(0,i.useState)(!1),[k,S]=(0,i.useState)(""),y=(0,i.useRef)(null),{register:w,handleSubmit:A,setValue:E}=(0,l.mN)(),F=a.find((t=>t.phoneNumber===d&&t.password===m));(0,i.useEffect)((()=>{if(F)for(const[t,e]of Object.entries(F))E(t,e)}),[F,E]);const M=()=>{const t=a.find((t=>t.phoneNumber===d&&t.password===m));var n;t&&parseInt(k)===j&&(console.log("Phone number verified successfully!"),null===(n=y.current)||void 0===n||n.submit(),e("/personalPage/".concat(t.userId)))};return(0,i.useEffect)((()=>{x(""===d||""===m)}),[d,m]),(0,c.jsx)("div",{className:n.parentContainer,children:N?(0,c.jsxs)("form",{onSubmit:A((t=>{M(),console.log("newdata",t)})),method:"post",action:"/reg",children:[(0,c.jsx)("input",{type:"hidden",name:"csrfmiddlewaretoken",value:t}),(0,c.jsxs)("div",{className:n.inputContainer,children:[(0,c.jsx)("div",{className:n.labelContainer,children:(0,c.jsx)("label",{htmlFor:"verification",children:"\u10e8\u10d4\u10d8\u10e7\u10d5\u10d0\u10dc\u10d4 \u10d5\u10d4\u10e0\u10d8\u10e4\u10d8\u10d9\u10d0\u10ea\u10d8\u10d8\u10e1 \u10d9\u10dd\u10d3\u10d8"})}),(0,c.jsx)("input",{id:"verification",type:"number",value:k,onChange:t=>S(t.target.value),className:n.formInput,onKeyDown:t=>{"-"!==t.key&&"E"!==t.key&&"e"!==t.key||t.preventDefault()}}),(0,c.jsx)("input",{type:"text",...w("verificationStatus")}),(0,c.jsx)("button",{type:"submit",children:"verification"})]})]}):(0,c.jsxs)("div",{className:n.mainContainer,children:[(0,c.jsx)("h2",{className:n.header,children:"\u10d0\u10d5\u10e2\u10dd\u10e0\u10d8\u10d6\u10d0\u10ea\u10d8\u10d0"}),(0,c.jsxs)("div",{className:n.authorization,children:[(0,c.jsx)("div",{className:n.authorization__labelContainer,children:(0,c.jsx)("label",{htmlFor:"phoneNumber",className:n.authorization__label,children:"\u10e2\u10d4\u10da\u10d4\u10e4\u10dd\u10dc\u10d8\u10e1 \u10dc\u10dd\u10db\u10d4\u10e0\u10d8"})}),(0,c.jsx)("input",{type:"text",name:"phoneNumber",id:"phoneNumber",className:n.authorization__input,onChange:t=>{f(t.target.value)}}),(0,c.jsx)("div",{className:n.authorization__labelContainer,children:(0,c.jsx)("label",{htmlFor:"password",className:n.authorization__label,children:"\u10de\u10d0\u10e0\u10dd\u10da\u10d8"})}),(0,c.jsxs)("div",{className:n.authorization__relativeBox,children:[(0,c.jsx)("input",{type:h?"text":"password",name:"password",id:"password",className:n.authorization__input,onChange:t=>{p(t.target.value)}}),(0,c.jsx)(s.g,{icon:h?u.pS3:u.k6j,className:n.faEye,onClick:()=>_(!h)})]}),b&&(0,c.jsx)("p",{className:n.authorization__errorMessage,children:"\u10db\u10dd\u10db\u10ee\u10db\u10d0\u10e0\u10d4\u10d1\u10da\u10d8\u10e1 \u10dc\u10dd\u10db\u10d4\u10e0\u10d8 \u10d0\u10dc \u10de\u10d0\u10e0\u10dd\u10da\u10d8 \u10d0\u10e0\u10d0\u10e1\u10ec\u10dd\u10e0\u10d8\u10d0"}),C?(0,c.jsx)("button",{disabled:!0,className:n.authorization__disabledButton,children:"\u10e8\u10d4\u10e1\u10d5\u10da\u10d0"}):(0,c.jsx)("button",{className:n.authorization__button,onClick:()=>{const t=a.find((t=>t.phoneNumber===d&&t.password===m));t?(z(!1),"false"===t.verificationStatus?((async t=>{const e=Math.floor(1e5+9e5*Math.random()),a="\u10d5\u10d4\u10e0\u10d8\u10e4\u10d8\u10d9\u10d0\u10ea\u10d8\u10d8\u10e1 \u10d9\u10dd\u10d3\u10d8: ".concat(e),n="http://smsoffice.ge/api/v2/send/?key=".concat("f5e53ecd65894293934d40e5c3bcd901","&destination=").concat(t,"&sender=").concat("xeloba.ge","&content=").concat(a,"&urgent=true");console.log(e),v(e);try{const t=await fetch(n),a=await t.json();return a.Success?e:(console.error("Failed to send OTP:",a.Message),null)}catch(o){return console.error("Error sending OTP:",o),null}})(t.phoneNumber),g(!0)):e("/personalPage/".concat(t.userId))):z(!0)},children:"\u10e8\u10d4\u10e1\u10d5\u10da\u10d0"})]})]})})}}}]);
//# sourceMappingURL=60.6bb19474.chunk.js.map